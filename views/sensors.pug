extends layout

block extrahead
  script(src="javascripts/sensors_scripts.js", type="text/javascript")
  script(src="javascripts/devices_scripts.js", type="text/javascript")



block content
  #new_sensor.modal.fade
    .modal-dialog.modal-lg
      .modal-content
        .modal-header
          h5.modal-title Add new sensor
          button.btn-close(type='button' data-bs-dismiss='modal' aria-label='Close')
        .modal-body.row
          table
            tbody
              tr
                th.py-3 Subsystem
                td
                  select.form-select(id="new_subsystem" name="new_subsystem")
              tr
                th.py-3 Topic
                td
                  select.form-select(id="new_topic" name="new_topic")
              tr
                th.py-3 Device
                td
                  select.form-select(id="new_device" name="new_device")
              tr
                th.py-3 Description
                td
                  input.form-control(type="text" id="new_description" name="new_description")
              tr
                th.py-3 Readout interval
                td
                  input.form-control(type="number" id="new_readout_interval" name="new_readout_interval")
              tr
                th.py-3 Units
                td
                  input.form-control(type="text" id="new_units" name="new_units")
              tr
                th.py-3 Readout command
                td
                  input.form-control(type="text" id="new_readout_command" name="new_readout_command")
              tr
                th.py-3 Transform
                td
                  input.form-control(type="text" id="new_value_xform" name="new_value_xform" placeholder="0,1")
              tr
                th.py-3 Integer quantity?
                td
                  input(type="checkbox" id="new_integer" name="new_integer")
              tr
                th.py-3 Control value
                td
                  input.form-control(type="text" id="new_control" name="new_control")
        .modal-footer
          button.btn.btn-success(type="button" onclick="ValidateNewSensor()") Validate
          button.btn.btn-warning(onclick="SubmitNewSensor()") Submit

  div.main-container
    table.table.table-hover.table-striped(data-bs-spy="scroll" data-bs-target="#navbar" data-bs-offset="0")#sensor_table
  script.
    $(document).ready(function () {
      PopulateSensorsNavbar();
      UpdateSensorTableOnce(regroup=true);
      setInterval(UpdateSensorTableOnce, 5000);
      var sensor = GetParameterByName('sensor');
      if (sensor) SensorDropdown(sensor);
      var query_search = new URLSearchParams(window.location.search);
      if (query_search.has('notify_msg')) {
        Notify(query_search.get('notify_msg'), query_search.get('notify_status'));
      };
    });
